{"version":3,"sources":["GameLayer.js"],"names":["spriteCreator","require","ConfirmDialogPrefab","StorageManager","self","cc","Class","extends","Component","properties","landRange","v2","landWidth","hero","Node","firstLand","secondLand","canvas","moveDuration","stickSpeed","heroMoveSpeed","stickWidth","isTouchStart","score","Label","highScore","perfectTips","onLoad","log","runLength","currentLandRange","heroWorldPosX","heroMoveX","scoreNum","winSize","director","getWinSize","highScoreNum","getHighestScore","string","exitDialog","registerEvent","createNewLand","curRange","getLandRange","setPosition","width","anchorX","x","stick","createStick","start","on","EventType","TOUCH_START","touchStart","bind","node","TOUCH_END","touchEnd","TOUCH_CANCEL","touchCancel","systemEvent","SystemEvent","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","console","unregisterEvent","targetOff","off","event","StickFall","keyCode","KEY","backspace","callFuncYes","end","callFuncNo","showDialog","getLandWidth","parent","Math","random","y","update","dt","height","HeroMoved","time","heroMove","moveBy","p","callFunc","isSuccess","se","sequence","runAction","stickFall","rotateBy","easing","easeIn","stickHeight","minLength","maxLength","middleLength","active","seq","delayTime","Next","GameOver","length","action","range","l","secondAction","setHighestScore","reStarGame","loadScene","exitGame","title","content","btn1Str","btn1Cb","btn2Str","btn2Cb","loader","loadRes","err","prefab","newNode","instantiate","getScene","addChild","getComponent","show"],"mappings":"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","file":"GameLayer.js","sourceRoot":"../../../../assets/Script","sourcesContent":["\nvar spriteCreator = require(\"spriteCreator\");\nvar ConfirmDialogPrefab = require(\"CommonDialg\");\nvar StorageManager = require(\"storageManager\");\n\n\nvar self = null;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        landRange:cc.v2(20,300),\n        landWidth:cc.v2(20,200),\n        hero:cc.Node,\n        firstLand:cc.Node,\n        secondLand:cc.Node,\n        canvas:cc.Node,  \n        moveDuration:0.5,\n        stickSpeed:400,\n        heroMoveSpeed:400,\n        stickWidth:6,\n        isTouchStart:false,\n        score:cc.Label,\n        highScore:cc.Label,\n        perfectTips:cc.Label,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        cc.log(\"onLoad ()\");\n\n        self = this;\n        this.runLength = 0;\n        this.currentLandRange = 0;\n        this.heroWorldPosX = 0;\n        this.heroMoveX = 0; \n        this.scoreNum = 0;\n        this.winSize = cc.director.getWinSize();\n\n\n        this.highScoreNum = StorageManager.getHighestScore();\n        this.highScore.string = \"最高得分:\"+this.highScoreNum;\n        this.exitDialog = false;\n\n        // this.perfectTips.node.active = true;\n\n        //注册触摸监听事件\n        this.registerEvent();\n        //创建一个新的陆地\n        this.createNewLand();\n        var curRange = this.getLandRange();\n        this.secondLand.setPosition(curRange,0);\n\n        //角色位置\n        this.heroWorldPosX = this.firstLand.width - (1-this.hero.anchorX) * this.hero.width - this.stickWidth;\n        this.hero.x = this.heroWorldPosX\n\n        //棍子位置\n        this.stick = this.createStick();\n        this.stick.x = this.hero.x + this.hero.width * (1-this.hero.anchorX) + this.stick.width * this.stick.anchorX;\n    },\n\n    start () {\n        cc.log(\"start ()\");\n    },\n    registerEvent(){\n        //触摸事件\n        this.canvas.on(cc.Node.EventType.TOUCH_START, this.touchStart.bind(this), this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this), this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this), this.node);\n\n        //键盘事件\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n        console.log(\"on\");\n    },\n    unregisterEvent(){\n        this.canvas.targetOff(this.node);\n\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n        console.log(\"off\");\n    },\n    touchStart(event){\n        // fsm.stickLengthen();\n        cc.log(\"touchStart\");\n        this.isTouchStart = true; \n        return false;\n    },\n    touchEnd(event){\n        // fsm.heroTick();\n        cc.log(\"touchEnd\");\n        this.isTouchStart = false;\n        this.StickFall();\n    },\n    touchCancel(){\n        // this.touchEnd();\n        cc.log(\"touchCancel\");\n        this.isTouchStart = false\n    },\n    onKeyDown(){\n        cc.log(\"keyDown:\"+event.keyCode);\n        switch(event.keyCode) {\n            case cc.KEY.backspace:\n                var callFuncYes = function(){\n                    cc.director.end();\n                };\n                var callFuncNo = function(){\n                    // cc.director.loadScene('gameScene');\n                    self.exitDialog = false;\n                };\n                if(!self.exitDialog){\n                    self.exitDialog = true;\n                    self.showDialog(\"通知\",\"是否退出游戏!\",\"是\",callFuncYes,\"\",callFuncNo);\n                }\n                break;\n        }\n    },\n    onKeyUp(){\n        cc.log(\"keyUp\");\n        switch(event.keyCode) {\n            case cc.KEY.backspace:\n                break;\n        }\n    },\n    createNewLand() {\n        cc.log(\">>>createNewLand\")\n        this.secondLand = spriteCreator.createNewLand(this.getLandWidth());\n        this.secondLand.parent = this.node;\n    },\n    getLandRange(){\n        var winSize = cc.director.getWinSize();\n        this.currentLandRange = 50+(winSize.width - this.secondLand.width)*Math.random();\n        if(winSize.width < this.currentLandRange + this.secondLand.width){\n            this.currentLandRange = winSize.width - this.secondLand.width - 50;\n        }\n        return this.currentLandRange;\n    },\n    getLandWidth(){\n        var landWidth = this.landWidth.x + (this.landWidth.y - this.landWidth.x)* Math.random();\n        if(landWidth<30){\n            landWidth = 30;\n        }\n        return landWidth;\n    },\n    createStick(){\n        cc.log(\"createStick\");\n        var stick = spriteCreator.createStick(this.stickWidth);\n        stick.parent = this.node;\n        return stick;\n    },\n    update (dt) {\n        if(this.isTouchStart)\n        {\n            // cc.log(\">>>>>>>> dt\");\n            this.stick.height += dt*this.stickSpeed;\n        }\n    },\n    //英雄移动\n    HeroMoved(){\n        cc.log(\">>>>HeroMoved\")\n\n        this.heroMoveX = this.stick.height\n        var time = this.heroMoveX/this.heroMoveSpeed;\n        var heroMove = cc.moveBy(time,cc.p(this.heroMoveX,0));\n\n        var callFunc = cc.callFunc(function(){\n            cc.log(\"成功失败判定\");\n            self.isSuccess();\n        });\n        var se =cc.sequence(heroMove,callFunc);\n        this.hero.runAction(se);\n    },\n    //棍子掉落\n    StickFall(){\n        this.unregisterEvent();\n        var stickFall = cc.rotateBy(0.5, 90);\n        stickFall.easing(cc.easeIn(3));\n        var callFunc = cc.callFunc(function(){\n            cc.log(\"hero move\");\n            self.HeroMoved();\n        });\n        var se =cc.sequence(stickFall,callFunc);\n        this.stick.runAction(se);\n\n        this.stickHeight = this.stick.height;\n    },\n    //成功失败判定\n    isSuccess(){\n        var minLength = this.secondLand.x - this.firstLand.x - this.firstLand.width+2;\n        var maxLength = this.secondLand.x - this.firstLand.x + this.secondLand.width - this.firstLand.width+5;\n\n        cc.log(\">>>minLength:\"+minLength+\">>>maxLength:\"+maxLength+\" height:\"+this.stickHeight);\n\n        if(this.stickHeight > minLength && this.stickHeight < maxLength)\n        {\n            cc.log(\">>>Success\")\n            //完美距离判定\n            var middleLength = maxLength - this.secondLand.width/2;\n            if(this.stickHeight > (middleLength - 6) && this.stickHeight < (middleLength + 3)){\n                this.scoreNum = this.scoreNum + 2;\n                this.score.string = \"得分:\"+this.scoreNum;\n\n                this.perfectTips.node.active = true;\n                var callFunc = cc.callFunc(function(){\n                    self.perfectTips.node.active = false;\n                });\n                var seq =cc.sequence(cc.delayTime(1.0),callFunc);\n                this.perfectTips.node.runAction(seq);\n            }else{\n                this.scoreNum = this.scoreNum + 1;\n                this.score.string = \"得分:\"+this.scoreNum;\n            }\n\n            this.Next();\n        }else{\n            cc.log(\">>>failed\")\n            this.GameOver();\n        }\n    },\n    Next(){\n        var winSize = cc.director.getWinSize();\n        cc.log(\"currentLandRange:\"+this.currentLandRange)\n        var length = this.currentLandRange + this.secondLand.width - 30;\n        this.runLength +=length;\n        var action = cc.moveBy(this.moveDuration,cc.p(-length,0));\n        this.node.runAction(action);\n\n        this.firstLand = this.secondLand;\n\n        this.createNewLand();\n\n        this.stick.height = 0;\n        var stickFall = cc.rotateBy(0.1, -90);\n        this.stick.runAction(stickFall);\n\n        //landRange\n        var range = this.getLandRange();\n\n        var callFunc = cc.callFunc(function(){\n            self.hero.x = self.runLength+10;\n            self.stick.x = self.hero.x + self.hero.width * (1-self.hero.anchorX) + self.stick.width * self.stick.anchorX;\n            self.registerEvent();\n        });\n\n        //secondland;\n        this.secondLand.setPosition(this.runLength+winSize.width,0);\n        var l = winSize.width - range;\n        var secondAction = cc.moveBy(this.moveDuration,cc.p(-l,0));\n        var seq =cc.sequence(secondAction,callFunc);\n        this.secondLand.runAction(seq);\n    },\n    GameOver(){\n\n        if(this.highScoreNum < this.scoreNum){\n            this.highScoreNum = this.scoreNum;\n            StorageManager.setHighestScore(this.highScoreNum);\n            this.highScore.string = \"最高得分:\"+this.highScoreNum;\n        }\n\n        var stickFall = cc.rotateBy(0.5, 90);\n        stickFall.easing(cc.easeIn(3));\n        this.stick.runAction(stickFall);\n        var action = cc.moveBy(0.5,cc.p(0,-350));\n        action.easing(cc.easeIn(3));\n        this.hero.runAction(action);\n\n        var reStarGame = function(){\n            cc.director.loadScene('gameScene');\n        };\n        var exitGame = function(){\n                    cc.director.end();\n                };\n        this.showDialog(\"通知\",\"游戏失败!\",\"再来一次\",reStarGame,\"\",exitGame);\n    },\n    // 弹出一个确认框\n    showDialog(title, content, btn1Str, btn1Cb, btn2Str, btn2Cb){\n        cc.log(\"showDialog \");\n        // 加载 Prefab\n        cc.loader.loadRes(\"CommonDialg\", function (err, prefab) {\n            if (err) {\n                cc.log(err);\n                return;\n            }\n            var newNode = cc.instantiate(prefab);\n            cc.director.getScene().addChild(newNode);\n            newNode.getComponent(ConfirmDialogPrefab).show(title, content, btn1Str, btn1Cb, btn2Str, btn2Cb);\n        });\n    },\n});\n\n\n\n\n"]}